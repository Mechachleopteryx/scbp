---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# scbp

<!-- badges: start -->
<!-- badges: end -->

scbp is boilerplate code for single cell analyses. Mostly thin wrappers on seurat functions. 

## Installation

``` r
remotes::install_github("rnabioco/scbp")
```


## plotting

```{r example}
library(scbp)
library(Seurat)

so <- Seurat::pbmc_small

plot_tsne(so, c("groups", "CST3"))
```


```{r}
plot_tsne(so, c("groups", "CST3"), group = "letter.idents")
```

Wrappers for common projections:

`plot_feature()`
`plot_umap()`
`plot_pca()`
`plot_tsne()`
`plot_harmony()`



### Summarizing functions

```{r}
get_metadata(so)
```

```{r}
plot_cell_proportions(so, "RNA_snn_res.1", "letter.idents")
```



```{r}
so <- calc_diversity(so,
               sample_id = "letter.idents",
               group_id = "RNA_snn_res.1") 

plot_tsne(so, "entropy")
```

## UCSC cellbrowser utils

Wrappers around UCSC cellbrowser generation routines. Uses data.table fwrite to speed up generating files.

```{r, eval = FALSE}

make_cellbrowser(so, 
                 column_list = c("orig.ident", "groups"),
                 project = "pbmcs",
                 primary_color_palette = RColorbrewer::brewer.pal("Paired"),
                 secondary_color_palette = scbp::palette_OkabeIto,
                 secondary_cols = "groups",
                 outdir = "cell_browser",
                 marker_file = "path/to/presto_or_seurat_marker_file.tsv",
                 ident = "groups",
                 embeddings = c("pca"),
                 config = list(priority = 4,   # options for cellbrowser.conf
                               radius = 5,
                               tags = "10x"),
                 description = list(    # options for summary.html
                   title = "Example cellbrowser",
                   description = "An informative description of this dataset"
)

build_cellbrowser(dataset_paths = "pbmcs/cell_browser/cellbrowser.conf",
                  outdir = file.path(cb_outdir, "pbmc_browser"))
```


## Others
  
`preprocess_bustools` read in bustools output and process with `DropletUtils::emptyDrops()`  

`plot_bc()` plot barcode distribution generated by `DropletUtils::barcodeRanks()`
